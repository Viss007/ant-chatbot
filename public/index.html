<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Ant Chatbot</title>
<style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:#0b0f14;color:#e6edf3;margin:0}header{padding:16px;border-bottom:1px solid #1f2937;background:#0f141b;position:sticky;top:0}main{max-width:820px;margin:0 auto;padding:16px}.msg{padding:12px 14px;border-radius:12px;margin:10px 0;white-space:pre-wrap;line-height:1.4}.user{background:#1e3a8a}.assistant{background:#0b3d3a}.meta{color:#9aa5b1;font-size:12px;margin-top:2px}form{display:flex;gap:8px;margin-top:16px}textarea{flex:1;background:#111827;color:#e6edf3;border:1px solid #374151;border-radius:8px;padding:10px;resize:vertical;min-height:72px}button{background:#2563eb;color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer}button:disabled{opacity:.6;cursor:not-allowed}</style>
</head><body><header><strong>Ant Chatbot</strong> â€” local demo</header><main><div id="history"></div><form id="form"><textarea id="q" placeholder="Ask a question..." maxlength="4000"></textarea><button id="send">Send</button></form><div class="meta" id="status"></div></main>
<script type="module">
import { v4 as uuidv4 } from "https://cdn.skypack.dev/uuid@9.0.1";
const sessionKey="ant_session_identifier"; let sessionId=localStorage.getItem(sessionKey)||uuidv4(); localStorage.setItem(sessionKey,sessionId);
const history=document.getElementById("history"), form=document.getElementById("form"), q=document.getElementById("q"), status=document.getElementById("status"), send=document.getElementById("send");
async function refresh(){ const r=await fetch(`/api/history?session_identifier=${encodeURIComponent(sessionId)}`); const d=await r.json(); history.innerHTML=""; (d.messages||[]).forEach(m=>{ const el=document.createElement("div"); el.className=`msg ${m.role}`; el.textContent=m.message_text; history.appendChild(el);}); history.scrollTop=history.scrollHeight; }
form.addEventListener("submit", async e=>{ e.preventDefault(); const question=q.value.trim(); if(!question) return; send.disabled=true; status.textContent="Thinking..."; try { const r=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question,session_identifier:sessionId})}); const d=await r.json(); if(r.ok){ await refresh(); status.textContent=`Tokens in ${d.usage?.inputTokens??"?"}, out ${d.usage?.outputTokens??"?"}, ${d.ms} ms`; } else { status.textContent=d.error||"Error"; } } catch(err){ status.textContent=err.message; } finally { send.disabled=false; q.value=""; } });
refresh();
</script></body></html>
